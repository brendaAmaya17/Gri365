<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GRI365 - Gestión de Proyectos</title>
    <link rel="stylesheet" href="./../styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
</head>
<body class="project-page">
    <div class="page-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="https://ik.imagekit.io/v3kitfabd/gri365/solo%20ojo%20oscuro.png?updatedAt=1759508923355" alt="Logo Claro" class="logo-light">
                <img src="https://ik.imagekit.io/v3kitfabd/gri365/solo%20ojo%20claro.png?updatedAt=1759508923395" alt="Logo Oscuro" class="logo-dark">
            </div>
            <nav class="navigation">
                <a class="nav-link" href="./../index.html"><span class="material-symbols-outlined">dashboard</span><span>Inicio</span></a>
                <a class="nav-link" href="#"><span class="material-symbols-outlined">list_alt</span><span>FixIT</span></a>
                <a class="nav-link active" href="./../pages/gestion.html"><span class="material-symbols-outlined">add_task</span><span>Gestión de Proyectos</span></a>
                <a class="nav-link" href="./../pages/marketing.html"><span class="material-symbols-outlined">linked_camera</span><span>CAM</span></a>
            </nav>
            <div class="sidebar-footer">
                <a class="nav-link" href="#"><span class="material-symbols-outlined">logout</span><span>Cerrar Sesión</span></a>
            </div>
        </aside>
        <main class="main-content">
            <header class="project-header">
                <div class="project-header-main">
                    <div class="project-logo">
                        <span class="material-symbols-outlined">add_task</span>
                        <h2>Gestión de Proyectos</h2>
                    </div>
                    <nav class="project-nav">
                        <a href="gestion.html">Dashboard</a>
                        <a href="tareas.html">Tareas</a>
                        <a href="calendario2.html">Calendario</a>
                        <a href="informes.html">Informes</a>
                    </nav>
                </div>
                <div class="header-actions">
                    <button id="theme-toggle-btn" class="icon-button" title="Alternar tema">
                        <span class="material-symbols-outlined sun-icon">light_mode</span>
                        <span class="material-symbols-outlined moon-icon">dark_mode</span>
                    </button>
                    <a href="#" class="icon-button" title="Cerrar Sesión">
                        <span class="material-symbols-outlined">logout</span>
                    </a>
                </div>
            </header>
            <main class="project-main-content">
                <div class="project-content-header">
                    <div>
                        <p class="project-title">Panel de Proyectos</p>
                        <p class="project-subtitle">Una vista general de todos tus proyectos.</p>
                    </div>
                    <button class="btn btn-primary create-project-btn" id="open-create-project-modal">
                        <span class="material-symbols-outlined">add</span>
                        <span>Crear Nuevo Proyecto</span>
                    </button>
                </div>
                <div class="project-filters">
                    <div class="search-bar">
                        <span class="material-symbols-outlined">search</span>
                        <input type="text" placeholder="Buscar proyectos...">
                    </div>
                    <div class="filter-tabs">
                        <button class="filter-tab active">Todos</button>
                        <button class="filter-tab">Activo</button>
                        <button class="filter-tab">Completado</button>
                        <button class="filter-tab">En pausa</button>
                    </div>
                </div>
                <div class="project-grid">
                    <div class="project-card" data-project-id="1">
                        <div class="card-header"><h3>Campaña de Marketing Q3</h3><span class="badge status-active">Activo</span></div>
                        <div class="progress-section">
                            <div class="progress-info"><span class="progress-label">Progreso</span><span class="progress-percent">65%</span></div>
                            <div class="progress-bar-wrapper"><div class="progress-bar" style="width: 65%;"></div></div>
                        </div>
                        <div class="card-meta">
                            <div><span class="meta-label">Vencimiento</span><span>15 Oct, 2024</span></div>
                            <div class="meta-right"><span class="meta-label">Tareas</span><span>8 pendientes</span></div>
                        </div>
                        <div class="card-team">
                            <span class="meta-label">Equipo</span>
                            <div class="avatar-group">
                                <img src="https://ik.imagekit.io/v3kitfabd/fotos/fotos/WhatsApp%20Image%202025-07-30%20at%203.16.09%20PM.jpeg?updatedAt=1754335165819" alt="Avatar">
                                <img src="https://ik.imagekit.io/v3kitfabd/fotos/fotos/WhatsApp%20Image%202025-07-30%20at%203.16.09%20PM%20(4).jpeg?updatedAt=1754335165735" alt="Avatar">
                                <img src="https://ik.imagekit.io/v3kitfabd/fotos/fotos/WhatsApp%20Image%202025-07-30%20at%203.16.10%20PM.jpeg?updatedAt=1754335165679" alt="Avatar">
                            </div>
                        </div>
                    </div>
                    <div class="project-card" data-project-id="2">
                        <div class="card-header"><h3>Rediseño del Sitio Web</h3><span class="badge status-completed">Completado</span></div>
                        <div class="progress-section">
                            <div class="progress-info"><span class="progress-label">Progreso</span><span class="progress-percent">100%</span></div>
                            <div class="progress-bar-wrapper"><div class="progress-bar" style="width: 100%;"></div></div>
                        </div>
                        <div class="card-meta">
                            <div><span class="meta-label">Vencimiento</span><span>20 Sep, 2024</span></div>
                            <div class="meta-right"><span class="meta-label">Tareas</span><span>0 pendientes</span></div>
                        </div>
                        <div class="card-team">
                            <span class="meta-label">Equipo</span>
                            <div class="avatar-group">
                                <img src="https://ik.imagekit.io/v3kitfabd/fotos/fotos/WhatsApp%20Image%202025-08-04%20at%203.59.32%20PM.jpeg?updatedAt=1754414061643" alt="Avatar">
                                <img src="https://ik.imagekit.io/v3kitfabd/fotos/fotos/WhatsApp%20Image%202025-07-30%20at%203.16.09%20PM.jpeg?updatedAt=1754335165819" alt="Avatar">
                            </div>
                        </div>
                    </div>
                    <div class="project-card" data-project-id="3">
                        <div class="card-header"><h3>Integración API</h3><span class="badge status-paused">En pausa</span></div>
                        <div class="progress-section">
                            <div class="progress-info"><span class="progress-label">Progreso</span><span class="progress-percent">20%</span></div>
                            <div class="progress-bar-wrapper"><div class="progress-bar" style="width: 20%;"></div></div>
                        </div>
                        <div class="card-meta">
                            <div><span class="meta-label">Vencimiento</span><span>30 Nov, 2024</span></div>
                            <div class="meta-right"><span class="meta-label">Tareas</span><span>15 pendientes</span></div>
                        </div>
                        <div class="card-team">
                            <span class="meta-label">Equipo</span>
                            <div class="avatar-group">
                                <img src="https://ik.imagekit.io/v3kitfabd/fotos/fotos/WhatsApp%20Image%202025-07-30%20at%203.16.10%20PM.jpeg?updatedAt=1754335165679" alt="Avatar">
                            </div>
                        </div>
                    </div>
                    <div class="project-card" data-project-id="4">
                        <div class="card-header"><h3>Desarrollo App Móvil</h3><span class="badge status-late">Atrasado</span></div>
                        <div class="progress-section">
                            <div class="progress-info"><span class="progress-label">Progreso</span><span class="progress-percent">80%</span></div>
                            <div class="progress-bar-wrapper"><div class="progress-bar" style="width: 80%;"></div></div>
                        </div>
                        <div class="card-meta">
                            <div><span class="meta-label due-date-late">Vencimiento</span><span class="due-date-late">01 Sep, 2024</span></div>
                            <div class="meta-right"><span class="meta-label">Tareas</span><span>3 pendientes</span></div>
                        </div>
                        <div class="card-team">
                            <span class="meta-label">Equipo</span>
                            <div class="avatar-group">
                                <img src="https://ik.imagekit.io/v3kitfabd/fotos/fotos/WhatsApp%20Image%202025-07-30%20at%203.16.09%20PM.jpeg?updatedAt=1754335165819" alt="Avatar">
                                <img src="https://ik.imagekit.io/v3kitfabd/fotos/fotos/WhatsApp%20Image%202025-07-30%20at%203.16.09%20PM%20(4).jpeg?updatedAt=1754335165735" alt="Avatar">
                                <img src="https://ik.imagekit.io/v3kitfabd/fotos/fotos/WhatsApp%20Image%202025-07-30%20at%203.16.10%20PM.jpeg?updatedAt=1754335165679" alt="Avatar">
                                <img src="https://ik.imagekit.io/v3kitfabd/fotos/fotos/WhatsApp%20Image%202025-08-04%20at%203.59.32%20PM.jpeg?updatedAt=1754414061643" alt="Avatar">
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </main>
    </div>

    <div id="project-details-modal" class="modal-overlay">
        <div class="modal-content project-details-content">
            <div class="modal-header">
                <h2 class="modal-title">Diseño de la nueva landing page</h2>
                <button class="modal-close-btn"><span class="material-symbols-outlined">close</span></button>
            </div>
            <div class="modal-body">
                 <div class="project-details-grid">
                    <div class="project-info-column">
                        <div class="project-meta-header">
                            <div>
                                <p class="project-meta-subtitle">Proyecto Titán</p>
                            </div>
                            <div class="project-meta-actions">
                                <button class="btn btn-secondary" id="edit-task-btn">Editar Tarea</button>
                                <button class="btn btn-success"><span class="material-symbols-outlined">check_circle</span> Completada</button>
                            </div>
                        </div>
                        <div class="project-tags">
                            <span class="tag tag-yellow">En progreso</span>
                            <span class="tag tag-red">Prioridad Alta</span>
                            <span class="tag tag-indigo">UI/UX</span>
                        </div>
                        <div class="project-assign-info">
                            <div class="assign-item">
                                <p class="assign-label">Asignado a</p>
                                <div class="user-chip"><img src="https://ik.imagekit.io/v3kitfabd/fotos/fotos/WhatsApp%20Image%202025-08-04%20at%203.59.32%20PM.jpeg?updatedAt=1754414061643" alt="Avatar"> Ana García</div>
                            </div>
                            <div class="assign-item">
                                <p class="assign-label">Fecha de Vencimiento</p>
                                <p>25 de Diciembre, 2023</p>
                            </div>
                        </div>
                        <div class="project-description-section">
                             <div class="canvas-actions">
                                <button class="icon-btn-small"><span class="material-symbols-outlined">edit</span></button>
                                <button class="icon-btn-small"><span class="material-symbols-outlined">note_add</span></button>
                             </div>
                             <div class="description-content">
                                <h3>Descripción</h3>
                                <p>Crear un diseño moderno y atractivo para la nueva página de inicio, siguiendo las directrices de la marca. La página debe ser responsive y estar optimizada para la conversión. Incluir secciones para características, testimonios y un formulario de contacto.</p>
                             </div>
                             <div class="attachments-content">
                                <h3>Archivos Adjuntos</h3>
                                <div class="attachments-grid">
                                    <div class="attachment-card">
                                        <div class="attachment-icon">
                                            <span class="material-symbols-outlined">image</span>
                                        </div>
                                        <div class="attachment-info">
                                            <p class="attachment-name">wireframe_v1.png</p>
                                            <a href="#" class="attachment-link">Descargar</a>
                                        </div>
                                    </div>
                                    <div class="attachment-card">
                                        <div class="attachment-icon">
                                            <span class="material-symbols-outlined">description</span>
                                        </div>
                                        <div class="attachment-info">
                                            <p class="attachment-name">brief_proyecto.pdf</p>
                                            <a href="#" class="attachment-link">Descargar</a>
                                        </div>
                                    </div>
                                </div>
                             </div>
                        </div>
                    </div>
                    <div class="project-comments-column">
                        <h3>Comentarios en Tiempo Real</h3>
                        <div class="comments-list">
                            <div class="comment-item right">
                                <div class="comment-bubble">
                                    <div class="comment-header"><span class="comment-author">Carlos Sánchez</span><span class="comment-time">Hace 2 horas</span></div>
                                    <p>¿Podemos revisar la paleta de colores? Creo que un tono más vibrante podría funcionar mejor para el CTA principal.</p>
                                </div>
                                <img src="https://ik.imagekit.io/v3kitfabd/fotos/fotos/WhatsApp%20Image%202025-07-30%20at%203.16.10%20PM.jpeg?updatedAt=1754335165679" alt="Avatar" class="comment-avatar">
                            </div>
                            <div class="comment-item left">
                                <img src="https://ik.imagekit.io/v3kitfabd/fotos/fotos/WhatsApp%20Image%202025-08-04%20at%203.59.32%20PM.jpeg?updatedAt=1754414061643" alt="Avatar" class="comment-avatar">
                                <div class="comment-bubble">
                                    <div class="comment-header"><span class="comment-author">Ana García</span><span class="comment-time">Hace 1 hora</span></div>
                                    <p>Buena idea, Carlos. He adjuntado un nuevo moodboard con algunas alternativas. Échale un vistazo.</p>
                                </div>
                            </div>
                        </div>
                        <div class="comment-input-area">
                            <img src="https://lh3.googleusercontent.com/a/ACg8ocLFXLCR-3-f-2k9_3Y-7E_M9Q-s7c8B-u-P-wH3Q-i-wQ=s96-c-rg-br100" alt="Avatar" class="comment-avatar-small">
                            <textarea placeholder="Escribe un comentario..."></textarea>
                            <button class="btn btn-primary" id="accept-comment-btn">Aceptar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="create-project-modal" class="modal-overlay">
        <div class="modal-content creation-modal-content">
            <!-- PASO 1: Información Básica -->
            <div id="modal-step-1" class="modal-view">
                <div class="creation-modal-header">
                    <div>
                        <p class="creation-modal-title">Crear Nuevo Proyecto</p>
                        <p class="creation-modal-subtitle">Rellene los siguientes datos para crear un nuevo proyecto.</p>
                    </div>
                    <button class="modal-close-btn"><span class="material-symbols-outlined">close</span></button>
                </div>
                <div class="creation-modal-body">
                    <div class="progress-stepper">
                        <div class="step active"><div class="step-circle">1</div><p>Información Básica</p></div>
                        <div class="step-line"></div>
                        <div class="step"><div class="step-circle">2</div><p>Tareas</p></div>
                        <div class="step-line"></div>
                        <div class="step"><div class="step-circle">3</div><p>Equipo y Roles</p></div>
                        <div class="step-line"></div>
                        <div class="step"><div class="step-circle">4</div><p>Presupuesto</p></div>
                    </div>
                    <div class="form-section">
                        <div class="form-group"><label for="project-name" class="form-label">Nombre del proyecto</label><input type="text" id="project-name" class="modal-input" placeholder="Introduzca el nombre del proyecto"></div>
                        <div class="form-group"><label for="description" class="form-label">Descripción (opcional)</label><textarea id="description" class="modal-textarea" placeholder="Introduzca una breve descripción del proyecto" rows="4"></textarea></div>
                        <div class="form-grid">
                            <div class="form-group"><label for="start-date" class="form-label">Fecha de inicio</label><div class="date-input-wrapper"><input type="text" id="start-date" class="modal-input" placeholder="Seleccionar fecha"><span class="material-symbols-outlined">calendar_today</span></div></div>
                            <div class="form-group"><label for="end-date" class="form-label">Fecha de finalización</label><div class="date-input-wrapper"><input type="text" id="end-date" class="modal-input" placeholder="Seleccionar fecha"><span class="material-symbols-outlined">calendar_today</span></div></div>
                        </div>
                    </div>
                </div>
                <div class="creation-modal-footer">
                    <button class="btn btn-secondary back-btn" disabled><span class="material-symbols-outlined">arrow_back</span><span>Atrás</span></button>
                    <button class="btn btn-primary next-btn"><span>Siguiente</span><span class="material-symbols-outlined">arrow_forward</span></button>
                </div>
            </div>

            <!-- PASO 2: Tareas -->
            <div id="modal-step-2" class="modal-view hidden">
                <div class="creation-modal-header">
                    <div>
                        <p class="creation-modal-title">Crear Nuevo Proyecto</p>
                        <p class="creation-modal-subtitle">Define las tareas principales del proyecto.</p>
                    </div>
                    <button class="modal-close-btn"><span class="material-symbols-outlined">close</span></button>
                </div>
                <div class="creation-modal-body">
                    <div class="progress-stepper">
                        <div class="step complete"><div class="step-circle"><span class="material-symbols-outlined">check</span></div></div><div class="step-line"></div>
                        <div class="step active"><div class="step-circle">2</div><p>Tareas</p></div>
                        <div class="step-line"></div>
                        <div class="step"><div class="step-circle">3</div><p>Equipo y Roles</p></div>
                        <div class="step-line"></div>
                        <div class="step"><div class="step-circle">4</div><p>Presupuesto</p></div>
                    </div>
                    <div class="form-section">
                        <p class="section-description">Agrega las tareas principales que componen este proyecto.</p>
                        <div id="tasks-container">
                            <div class="task-input-group">
                                <div class="task-number">1</div>
                                <input type="text" class="modal-input task-input" placeholder="Nombre de la tarea">
                                <button class="btn-icon-remove" title="Eliminar tarea"><span class="material-symbols-outlined">close</span></button>
                            </div>
                        </div>
                        <button class="btn btn-secondary add-task-btn">
                            <span class="material-symbols-outlined">add</span>
                            <span>Agregar Tarea</span>
                        </button>
                    </div>
                </div>
                <div class="creation-modal-footer">
                    <button class="btn btn-secondary back-btn"><span class="material-symbols-outlined">arrow_back</span><span>Atrás</span></button>
                    <button class="btn btn-primary next-btn"><span>Siguiente</span><span class="material-symbols-outlined">arrow_forward</span></button>
                </div>
            </div>
            
            <!-- PASO 3: Equipo y Roles -->
            <div id="modal-step-3" class="modal-view hidden">
                <div class="creation-modal-header">
                    <div>
                        <p class="creation-modal-title">Crear Nuevo Proyecto</p>
                        <p class="creation-modal-subtitle">Asigna roles y miembros a tu equipo.</p>
                    </div>
                    <button class="modal-close-btn"><span class="material-symbols-outlined">close</span></button>
                </div>
                <div class="creation-modal-body">
                    <div class="progress-stepper">
                        <div class="step complete"><div class="step-circle"><span class="material-symbols-outlined">check</span></div></div><div class="step-line"></div>
                        <div class="step complete"><div class="step-circle"><span class="material-symbols-outlined">check</span></div></div><div class="step-line"></div>
                        <div class="step active"><div class="step-circle">3</div><p>Equipo y Roles</p></div>
                        <div class="step-line"></div>
                        <div class="step"><div class="step-circle">4</div><p>Presupuesto</p></div>
                    </div>
                    <div class="team-builder-grid">
                        <div class="roles-panel">
                            <p class="roles-title">Roles Disponibles</p>
                            <div class="roles-list">
                                <div class="role-card"><span class="material-symbols-outlined">group</span><div><p>Gerente de Proyecto</p><span>Lidera la planificación.</span></div></div>
                                <div class="role-card"><span class="material-symbols-outlined">design_services</span><div><p>Diseñador UX/UI</p><span>Define la experiencia.</span></div></div>
                                <div class="role-card"><span class="material-symbols-outlined">code</span><div><p>Desarrollador Frontend</p><span>Implementa la interfaz.</span></div></div>
                                <div class="role-card"><span class="material-symbols-outlined">cloud</span><div><p>Desarrollador Backend</p><span>Construye la lógica.</span></div></div>
                                <div class="role-card"><span class="material-symbols-outlined">bug_report</span><div><p>Tester QA</p><span>Asegura la calidad.</span></div></div>
                            </div>
                        </div>
                        <div class="team-canvas">
                            <p class="roles-title">Estructura del Equipo</p>
                            <div class="canvas-dropzone">
                                <p>Arrastra y suelta roles aquí para empezar.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="creation-modal-footer">
                    <button class="btn btn-secondary back-btn"><span class="material-symbols-outlined">arrow_back</span><span>Atrás</span></button>
                    <button class="btn btn-primary next-btn"><span>Siguiente</span><span class="material-symbols-outlined">arrow_forward</span></button>
                </div>
            </div>

            <!-- PASO 4: Presupuesto -->
            <div id="modal-step-4" class="modal-view hidden">
                 <div class="creation-modal-header">
                    <div>
                        <p class="creation-modal-title">Crear Nuevo Proyecto</p>
                        <p class="creation-modal-subtitle">Define el presupuesto del proyecto.</p>
                    </div>
                    <button class="modal-close-btn"><span class="material-symbols-outlined">close</span></button>
                </div>
                <div class="creation-modal-body">
                    <div class="progress-stepper">
                        <div class="step complete"><div class="step-circle"><span class="material-symbols-outlined">check</span></div></div><div class="step-line"></div>
                        <div class="step complete"><div class="step-circle"><span class="material-symbols-outlined">check</span></div></div><div class="step-line"></div>
                        <div class="step complete"><div class="step-circle"><span class="material-symbols-outlined">check</span></div></div><div class="step-line"></div>
                        <div class="step active"><div class="step-circle">4</div><p>Presupuesto</p></div>
                    </div>
                    <div class="form-section">
                        <div class="form-group">
                            <label for="budget-total" class="form-label">Presupuesto Total</label>
                            <div class="currency-input-wrapper">
                                <span class="currency-symbol">$</span>
                                <input type="number" id="budget-total" class="modal-input currency-input" placeholder="0.00">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Distribución del Presupuesto</label>
                            <div class="budget-categories">
                                <div class="budget-category-item">
                                    <label>Recursos Humanos</label>
                                    <input type="number" class="modal-input" placeholder="0.00">
                                </div>
                                <div class="budget-category-item">
                                    <label>Tecnología y Herramientas</label>
                                    <input type="number" class="modal-input" placeholder="0.00">
                                </div>
                                <div class="budget-category-item">
                                    <label>Marketing y Publicidad</label>
                                    <input type="number" class="modal-input" placeholder="0.00">
                                </div>
                                <div class="budget-category-item">
                                    <label>Otros Gastos</label>
                                    <input type="number" class="modal-input" placeholder="0.00">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="creation-modal-footer">
                    <button class="btn btn-secondary back-btn"><span class="material-symbols-outlined">arrow_back</span><span>Atrás</span></button>
                    <button class="btn btn-primary" id="send-request">Crear Proyecto</button>
                </div>
            </div>
        </div>
    </div>

    <div id="toast" class="toast-overlay">
        <div class="toast-message">
            <button class="close-toast"><span class="material-symbols-outlined">close</span></button>
            <div class="toast-content">
                <div class="toast-header">
                    <div class="icon"><span class="material-symbols-outlined">check_circle</span></div>
                    <h3 id="toast-title">Proyecto Creado con Éxito</h3>
                </div>
                <p id="toast-description">Tu nuevo proyecto ha sido registrado correctamente.</p>
            </div>
        </div>
    </div>

    <!-- Modal de Edición de Tarea -->
    <div id="edit-task-modal" class="modal-overlay">
        <div class="modal-content creation-modal-content">
            <div class="modal-view">
                <div class="creation-modal-header">
                    <div>
                        <p class="creation-modal-title">Editar Tarea</p>
                        <p class="creation-modal-subtitle">Actualiza la información de la tarea.</p>
                    </div>
                    <button class="modal-close-btn" id="close-edit-modal"><span class="material-symbols-outlined">close</span></button>
                </div>
                <div class="creation-modal-body">
                    <div class="form-section">
                        <div class="form-group">
                            <label for="edit-task-name" class="form-label">Nombre de la tarea</label>
                            <input type="text" id="edit-task-name" class="modal-input" placeholder="Nombre de la tarea">
                        </div>
                        <div class="form-group">
                            <label for="edit-task-description" class="form-label">Descripción</label>
                            <textarea id="edit-task-description" class="modal-textarea" placeholder="Descripción de la tarea" rows="4"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="edit-task-assignee" class="form-label">Asignado a</label>
                            <input type="text" id="edit-task-assignee" class="modal-input" placeholder="Nombre del asignado">
                        </div>
                        <div class="form-group">
                            <label for="edit-task-date" class="form-label">Fecha de Vencimiento</label>
                            <div class="date-input-wrapper">
                                <input type="text" id="edit-task-date" class="modal-input" placeholder="Seleccionar fecha">
                                <span class="material-symbols-outlined">calendar_today</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Estado</label>
                            <select id="edit-task-status" class="modal-input">
                                <option value="En progreso">En progreso</option>
                                <option value="Completada">Completada</option>
                                <option value="Pendiente">Pendiente</option>
                                <option value="En revisión">En revisión</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Prioridad</label>
                            <select id="edit-task-priority" class="modal-input">
                                <option value="">Seleccionar prioridad</option>
                                <option value="Prioridad Alta">Prioridad Alta</option>
                                <option value="Prioridad Media">Prioridad Media</option>
                                <option value="Prioridad Baja">Prioridad Baja</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Categoría</label>
                            <select id="edit-task-category" class="modal-input">
                                <option value="">Seleccionar categoría</option>
                                <option value="CAM">CAM</option>
                                <option value="TIC">TIC</option>
                                <option value="UI/UX">UI/UX</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="creation-modal-footer">
                    <button class="btn btn-secondary" id="cancel-edit-btn">Cancelar</button>
                    <button class="btn btn-primary" id="save-edit-btn">Guardar Cambios</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ===== SCRIPT DE TEMA =====
        const themeToggleBtn = document.getElementById('theme-toggle-btn');
        const body = document.body;
        const applySavedTheme = () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                body.classList.add('dark-mode');
            }
        };
        themeToggleBtn.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            localStorage.setItem('theme', body.classList.contains('dark-mode') ? 'dark' : 'light');
        });
        document.addEventListener('DOMContentLoaded', applySavedTheme);

        // ===== SCRIPT PARA MODALES Y TOAST =====
        document.addEventListener('DOMContentLoaded', () => {
            // --- Lógica para el Modal de Detalles del Proyecto ---
            const detailsModal = document.getElementById('project-details-modal');
            if (detailsModal) {
                const closeDetailsBtn = detailsModal.querySelector('.modal-close-btn');
                const projectCards = document.querySelectorAll('.project-card');
                const acceptCommentBtn = document.getElementById('accept-comment-btn');

                projectCards.forEach(card => {
                    card.addEventListener('click', () => {
                        detailsModal.classList.add('active');
                    });
                });

                closeDetailsBtn.addEventListener('click', () => {
                    detailsModal.classList.remove('active');
                });

                detailsModal.addEventListener('click', (e) => {
                    if (e.target === detailsModal) {
                        detailsModal.classList.remove('active');
                    }
                });

                // Cerrar modal al hacer clic en Aceptar (comentarios)
                if (acceptCommentBtn) {
                    acceptCommentBtn.addEventListener('click', () => {
                        detailsModal.classList.remove('active');
                    });
                }
            }

            // --- Lógica para el Modal de Creación de Proyecto ---
            const createModal = document.getElementById('create-project-modal');
            if (createModal) {
                const openCreateBtn = document.getElementById('open-create-project-modal');
                const closeCreateBtns = createModal.querySelectorAll('.modal-close-btn');
                
                const steps = createModal.querySelectorAll('.modal-view');
                const nextBtns = createModal.querySelectorAll('.next-btn');
                const backBtns = createModal.querySelectorAll('.back-btn');
                const sendBtn = createModal.querySelector('#send-request');
                
                const toast = document.getElementById("toast");
                const closeToast = document.querySelector(".close-toast");

                // Lógica para agregar tareas dinámicamente
                const tasksContainer = document.getElementById('tasks-container');
                const addTaskBtn = createModal.querySelector('.add-task-btn');

                if (addTaskBtn) {
                    addTaskBtn.addEventListener('click', () => {
                        const taskCount = tasksContainer.children.length + 1;
                        const newTaskGroup = document.createElement('div');
                        newTaskGroup.className = 'task-input-group';
                        newTaskGroup.innerHTML = `
                            <div class="task-number">${taskCount}</div>
                            <input type="text" class="modal-input task-input" placeholder="Nombre de la tarea">
                            <button class="btn-icon-remove" title="Eliminar tarea"><span class="material-symbols-outlined">close</span></button>
                        `;
                        tasksContainer.appendChild(newTaskGroup);

                        // Agregar evento para eliminar tarea
                        const removeBtn = newTaskGroup.querySelector('.btn-icon-remove');
                        removeBtn.addEventListener('click', () => {
                            newTaskGroup.remove();
                            updateTaskNumbers();
                        });
                    });
                }

                // Función para actualizar los números de las tareas
                function updateTaskNumbers() {
                    const taskGroups = tasksContainer.querySelectorAll('.task-input-group');
                    taskGroups.forEach((group, index) => {
                        const numberDiv = group.querySelector('.task-number');
                        if (numberDiv) {
                            numberDiv.textContent = index + 1;
                        }
                    });
                }

                // Agregar evento a los botones de eliminar existentes
                tasksContainer.addEventListener('click', (e) => {
                    if (e.target.closest('.btn-icon-remove')) {
                        const taskGroup = e.target.closest('.task-input-group');
                        if (tasksContainer.children.length > 1) {
                            taskGroup.remove();
                            updateTaskNumbers();
                        }
                    }
                });

                let currentStep = 0;

                const showStep = (stepIndex) => {
                    steps.forEach((step, index) => {
                        step.classList.toggle('hidden', index !== stepIndex);
                    });
                    // Habilitar/deshabilitar botón "Atrás"
                    backBtns.forEach(btn => {
                        const parentStep = btn.closest('.modal-view');
                        if (parentStep === steps[0]) {
                            btn.disabled = true;
                        } else {
                            btn.disabled = false;
                        }
                    });
                };

                const openModal = () => {
                    currentStep = 0;
                    showStep(currentStep);
                    createModal.classList.add('active');
                };

                const closeModal = () => {
                    createModal.classList.remove('active');
                };

                openCreateBtn.addEventListener('click', openModal);
                closeCreateBtns.forEach(btn => btn.addEventListener('click', closeModal));
                createModal.addEventListener('click', (e) => { if (e.target === createModal) closeModal(); });

                nextBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        if (currentStep < steps.length - 1) {
                            currentStep++;
                            showStep(currentStep);
                        }
                    });
                });

                backBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        if (currentStep > 0) {
                            currentStep--;
                            showStep(currentStep);
                        }
                    });
                });

                // Lógica de activación del Toast al hacer click en el botón final
                if (sendBtn) {
                    sendBtn.addEventListener('click', () => {
                        closeModal();
                        if (toast) {
                            toast.style.display = "flex";
                        }
                    });
                }

                if (closeToast) {
                    closeToast.addEventListener('click', () => {
                        toast.querySelector(".toast-message").style.animation = "fadeOut 0.4s forwards";
                        setTimeout(() => {
                            toast.style.display = "none";
                            toast.querySelector(".toast-message").style.animation = "fadeIn 0.4s forwards";
                        }, 400);
                    });
                }
            }

            // --- Lógica para Editar Tarea ---
            const editTaskBtn = document.getElementById('edit-task-btn');
            const editTaskModal = document.getElementById('edit-task-modal');
            const closeEditModal = document.getElementById('close-edit-modal');
            const cancelEditBtn = document.getElementById('cancel-edit-btn');
            const saveEditBtn = document.getElementById('save-edit-btn');
            
            // Elementos de la tarea que se van a editar
            const taskTitle = document.querySelector('.modal-title');
            const taskDescription = document.querySelector('.description-content p');
            const taskAssignee = document.querySelector('.user-chip');
            const taskDate = document.querySelector('.assign-item p:last-child');
            const taskTags = document.querySelector('.project-tags');

            // Variables para guardar los valores originales
            let originalValues = {};

            if (editTaskBtn) {
                editTaskBtn.addEventListener('click', () => {
                    // Cargar datos actuales en el formulario
                    const currentTitle = taskTitle.textContent;
                    const currentDescription = taskDescription.textContent;
                    const currentAssignee = taskAssignee.textContent.trim();
                    const currentDate = taskDate.textContent;

                    document.getElementById('edit-task-name').value = currentTitle;
                    document.getElementById('edit-task-description').value = currentDescription;
                    document.getElementById('edit-task-assignee').value = currentAssignee;
                    document.getElementById('edit-task-date').value = currentDate;
                    
                    // Obtener estado, prioridad y categoría actuales
                    let currentStatus = '';
                    let currentPriority = '';
                    let currentCategory = '';

                    const tags = taskTags.querySelectorAll('.tag');
                    tags.forEach(tag => {
                        const text = tag.textContent;
                        if (text === 'En progreso' || text === 'Completada' || text === 'Pendiente' || text === 'En revisión') {
                            currentStatus = text;
                            document.getElementById('edit-task-status').value = text;
                        } else if (text.includes('Prioridad')) {
                            currentPriority = text;
                            document.getElementById('edit-task-priority').value = text;
                        } else if (text === 'UI/UX' || text === 'TIC' || text === 'CAM') {
                            currentCategory = text;
                            document.getElementById('edit-task-category').value = text;
                        }
                    });

                    // Guardar valores originales
                    originalValues = {
                        title: currentTitle,
                        description: currentDescription,
                        assignee: currentAssignee,
                        date: currentDate,
                        status: currentStatus,
                        priority: currentPriority,
                        category: currentCategory
                    };
                    
                    editTaskModal.classList.add('active');
                });
            }

            const closeEditTaskModal = () => {
                editTaskModal.classList.remove('active');
            };

            if (closeEditModal) {
                closeEditModal.addEventListener('click', closeEditTaskModal);
            }

            if (cancelEditBtn) {
                cancelEditBtn.addEventListener('click', closeEditTaskModal);
            }

            if (editTaskModal) {
                editTaskModal.addEventListener('click', (e) => {
                    if (e.target === editTaskModal) {
                        closeEditTaskModal();
                    }
                });
            }

            if (saveEditBtn) {
                saveEditBtn.addEventListener('click', () => {
                    // Obtener nuevos valores
                    const newTitle = document.getElementById('edit-task-name').value;
                    const newDescription = document.getElementById('edit-task-description').value;
                    const newAssignee = document.getElementById('edit-task-assignee').value;
                    const newDate = document.getElementById('edit-task-date').value;
                    const newStatus = document.getElementById('edit-task-status').value;
                    const newPriority = document.getElementById('edit-task-priority').value;
                    const newCategory = document.getElementById('edit-task-category').value;

                    // Verificar si hubo cambios
                    const hasChanges = (
                        newTitle !== originalValues.title ||
                        newDescription !== originalValues.description ||
                        newAssignee !== originalValues.assignee ||
                        newDate !== originalValues.date ||
                        newStatus !== originalValues.status ||
                        newPriority !== originalValues.priority ||
                        newCategory !== originalValues.category
                    );

                    if (hasChanges) {
                        // Actualizar título
                        if (newTitle) taskTitle.textContent = newTitle;

                        // Actualizar descripción
                        if (newDescription) taskDescription.textContent = newDescription;

                        // Actualizar asignado
                        if (newAssignee) {
                            const assigneeText = taskAssignee.childNodes[1];
                            if (assigneeText) {
                                assigneeText.textContent = ' ' + newAssignee;
                            }
                        }

                        // Actualizar fecha
                        if (newDate) taskDate.textContent = newDate;

                        // Mapear estados a colores
                        const statusColors = {
                            'En progreso': 'tag-yellow',
                            'Completada': 'tag-green',
                            'Pendiente': 'tag-gray',
                            'En revisión': 'tag-blue'
                        };

                        const priorityColors = {
                            'Prioridad Alta': 'tag-red',
                            'Prioridad Media': 'tag-orange',
                            'Prioridad Baja': 'tag-blue'
                        };

                        const categoryColors = {
                            'UI/UX': 'tag-indigo',
                            'TIC': 'tag-purple',
                            'CAM': 'tag-pink'
                        };

                        // Construir HTML de tags solo con los valores seleccionados
                        let tagsHTML = '';
                        if (newStatus) {
                            tagsHTML += `<span class="tag ${statusColors[newStatus] || 'tag-yellow'}">${newStatus}</span>`;
                        }
                        if (newPriority) {
                            tagsHTML += `<span class="tag ${priorityColors[newPriority] || 'tag-red'}">${newPriority}</span>`;
                        }
                        if (newCategory) {
                            tagsHTML += `<span class="tag ${categoryColors[newCategory] || 'tag-indigo'}">${newCategory}</span>`;
                        }

                        // Actualizar etiquetas
                        taskTags.innerHTML = tagsHTML;

                        // Cerrar modal
                        closeEditTaskModal();

                        // Mostrar toast de éxito
                        const toastTitle = document.getElementById('toast-title');
                        const toastDescription = document.getElementById('toast-description');
                        const toast = document.getElementById("toast");
                        
                        toastTitle.textContent = 'Tarea Actualizada con Éxito';
                        toastDescription.textContent = 'Los cambios se han guardado correctamente.';
                        
                        if (toast) {
                            toast.style.display = "flex";
                        }
                    } else {
                        // No hay cambios, solo cerrar modal
                        closeEditTaskModal();
                    }
                });
            }
        });
    </script>
</body>
</html>